% this script test assemble m, c, k in Hs, 
% case 1. multiply Psi matrix, then multiply rvCol
% case 2. multiply Psi vector (reshaped), then .* rvCol.
% is case 1 and case 2 equivalent?

m = canti.mas.mtx;
c = canti.dam.mtx;
k = canti.sti.full;

nd = canti.no.dof;
nt = 2;

mtxi = ones(nd, nd);
mtxz = zeros(nd, nd);
Hs = [m c k; mtxz mtxi mtxz; mtxz mtxz mtxi];
Hz = zeros(length(Hs), length(Hs));

A = [Hs Hz; Hz Hs];

phi = canti.phi.val;
phiz = zeros(size(phi, 1), size(phi, 2));

rv = [1:];

%% case 1
mtxphi = cell(3 * nt, 3 * nt);
for i = 1:3 * nt
    for j = 1:3 * nt
        if i == j
            mtxphi(i, j) = {phi};
        else
            mtxphi(i, j) = {phiz};
        end
    end
end
        
mtxphi = cell2mat(mtxphi);

